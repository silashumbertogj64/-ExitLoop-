# -ExitLoop-
; =============================================================================================================================== Func _WD_WaitElementVisible($sSession, $sStrategy, $sSelector, $iDelay = 0, $iTimeout = -1)     Local Const $sFuncName = "_WD_WaitElement"     Local $bAbort = False, $iErr, $iResult      If $iTimeout = -1 Then $iTimeout = $_WD_DefaultTimeout      Sleep($iDelay)      Local $hWaitTimer = TimerInit()      While 1         $FindRet = _WD_FindElement($sSession, $sStrategy, $sSelector)         $iErr = @error          If $iErr = $_WD_ERROR_Success Then             Local $sJsonElement = '{"' &amp; $_WD_ELEMENT_ID &amp; '":"' &amp; $FindRet &amp; '"}'             $sResponse = _WD_ExecuteScript($sSession, "return arguments[0].offsetWidth || arguments[0].offsetHeight || arguments[0].getClientRects().length", $sJsonElement)             ;Not visible returns {"value":0}             ;Visible returns a # for example {"value":115}             $sJSON = Json_Decode($sResponse)            ;Use Json_Decode to pull just the value from the response             $isVisible = Json_Get($sJSON, "[value]")             If $isVisible > 0 Then                 $iResult = 1                 ExitLoop             EndIf          ElseIf $iErr = $_WD_ERROR_NoMatch Then             If (TimerDiff($hWaitTimer) > $iTimeout) Then                 $iErr = $_WD_ERROR_Timeout                 ExitLoop             EndIf         Else             ExitLoop         EndIf          Sleep(1000)     WEnd      Return SetError(__WD_Error($sFuncName, $iErr), $iResult) EndFunc
